@model IEnumerable<Blog>

<div class=" row pb-3">
	@foreach (var blog in Model.OrderByDescending(u => u.ngayTao))
	{
		<div class="col-lg-9 col-sm-3 right-wrap-field">
			<div class="row p-2">
				<div class="col-12 p-1">
					<div class="post border rounded p-3 mb-3" data-post-id="@blog.id_Blog">
						<div class="card-body border-0 p-1 border-2 rounded">
							<h4><i class="bi bi-person"></i> Admin</h4>
							<small>Create at: @blog.ngayTao.ToString("dd/MM/yyyy")</small>
							<hr>
							<h5 class="text-center">@blog.tilte</h5>
							
						</div>
						
						<p>@Html.Raw(blog.content)</p>
						<div class="border-0 p-2 shadow rounded" style="width: 100%; height:auto">
								<img src="@blog.ImageUrl" class="card-img-top rounded form-control" alt="@blog.tilte">
						</div>
						<!-- Nút tương tác -->
						<div class="mt-3 d-flex gap-2 text-center">
							<button class="btn btn-outline-primary btn-sm" style="width:33%" onclick="likePost(@blog.id_Blog)">
								<i class="bi bi-heart"></i> Like (<span id="like-count-@blog.id_Blog">0</span>)
							</button>
							<button class="btn btn-outline-secondary btn-sm" style="width:33%" onclick="toggleComment(@blog.id_Blog)">
								<i class="bi bi-chat-dots"></i> Comment
							</button>
							<button class="btn btn-outline-success btn-sm" style="width:33%" onclick="sharePost(@blog.id_Blog)">
								<i class="bi bi-share"></i> Share
							</button>
						</div>
						<!-- Khu vực bình luận -->
						<div id="comment-section-@blog.id_Blog" class="mt-2" style="display:none;">
							<textarea class="form-control mb-2" placeholder="Nhập bình luận..." id="comment-input-@blog.id_Blog"></textarea>
							<button class="btn btn-sm btn-primary" onclick="addComment@blog.id_Blog)">Gửi</button>
							<ul id="comment-list-@blog.id_Blog" class="list-unstyled mt-2"></ul>
						</div>
					</div>
				</div>
			</div>
		</div>
	}
</div>




@section Scripts {
	<script>
		const likeCounts = {};

		function likePost(id_Blog) {
			likeCounts[id_Blog] = (likeCounts[id_Blog] || 0) + 1;
			document.getElementById(`like-count-${id_Blog}`).textContent = likeCounts[id_Blog];
		}

		function toggleComment(id_Blog) {
			const section = document.getElementById(`comment-section-${id_Blog}`);
			section.style.display = (section.style.display === "none") ? "block" : "none";
		}

		function addComment(id_Blog) {
			const input = document.getElementById(`comment-input-${id_Blog}`);
			const list = document.getElementById(`comment-list-${id_Blog}`);

			if (input.value.trim() === '') return;

			const li = document.createElement('li');
			li.textContent = "Bạn: " + input.value;
			list.appendChild(li);
			input.value = '';
		}

		function sharePost(id_Blog) {
			const url = window.location.href + "#post-" + id_Blog;
			navigator.clipboard.writeText(url).then(() => {
				alert("Đã sao chép liên kết bài viết!");
			});
		}
	</script>
}